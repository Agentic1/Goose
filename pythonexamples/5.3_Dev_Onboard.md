# 5.3 Developer Onboard

This guide walks through connecting a new agent to the AEtherBus and common platform services.
It includes runnable snippets so you can copy/paste and experiment quickly.

## 1. Connect to the Bus

Every agent uses `build_redis_url()` from `AG1_AEtherBus.bus` to get its Redis connection string. Load your access key from a config file or environment variable:

```python
import json
from AG1_AEtherBus.bus import build_redis_url
from redis.asyncio import Redis

with open('config.json') as f:
    cfg = json.load(f)

redis = await Redis.from_url(build_redis_url(access_key=cfg['access_key']), decode_responses=True)
```

## 2. Register with the Orchestrator

Use `BusAdapterV2` and provide a `registration_profile` so your agent is discoverable:

```python
from AG1_AEtherBus.bus_adapterV2 import BusAdapterV2
from AG1_AEtherBus.envelope import Envelope

profile = {
    'auth_key': cfg['access_key'],
    'agent_name': cfg['agent_name'],
    'description': 'Example dev agent',
    'connector_type': 'delegate',
    'target_inbox': f"AG1:agent:{cfg['agent_name']}:inbox",
    'connector_details': {},
}

adapter = BusAdapterV2(
    agent_id=cfg['agent_name'],
    redis_client=redis,
    core_handler=my_handler,
    patterns=[f"AG1:agent:{cfg['agent_name']}:inbox"],
    group=cfg['agent_name'],
    registration_profile=profile,
)
await adapter.start()
```

## 3. Connect to Telegram

Register with the `tg_edge_handler` so the agent can chat via a Telegram bot:

```python
from AG1_AEtherBus.agent_bus_minimal import register_with_tg_handler
await register_with_tg_handler(cfg, redis)
```

This assumes your `config.json` contains `tg_handle` and the bot token `key`.

## 4. Connect to AetherDeck

To appear inside the AetherDeck web UI, register with the `aetherdeck_relay_handler`:

```python
from AG1_AEtherBus.agent_bus_minimal import register_with_aetherdeck_relay
await register_with_aetherdeck_relay(cfg, redis)
```

Once registered, UI messages will arrive on `AG1:edge:aetherdeckv1:<user>:response` and your agent can reply by publishing to that stream.

## 5. Calling Other Agents

After registration, use the Orchestrator to locate other agents and send them envelopes.
A simple helper is `ask_agent` used by `MuseAgent`:

```python
from AG1_Muse.muse_agent.tool_registry import ask_agent
response = await ask_agent(redis, 'SystemControl', {'action': 'get_status'}, user_id='demo')
print(response)
```

This sends a request to the SystemAgent through the Orchestrator registry.

